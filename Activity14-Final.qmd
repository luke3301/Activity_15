---
title: "Activity #14" 
subtitle: "Stat 184" 
author: "Luke Shoemaker" 
date: today 
date-modified: now 
format:
  html: 
    toc: false
    code-overflow: wrap
    number-sections: true
    cap-location: top
    fig-align: center
    fig-cap-location: top
editor: visual
execute:
  echo: false
  warning: false
---

# Activity 14

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## US Armed Forces Problem

### Load Data sets

```{r}
US_Troops <- read.csv("US_Armed_Forces_2024.csv", skip = 1)
library(babynames)
```

### Load Necessary Libraries

```{r, echo = FALSE}
library(ggplot2)
library(tidyr)
library(dplyr)
library(readr)
library(knitr)
```

### US Armed Forces Data Set

```{r}
colnames(US_Troops) = c("Pay_Grade", "Army_Male", "Army_Female", "Army_Total", "Navy_Male", "Navy_Female", "Navy_Total", "MarineCorps_Male", "MarineCorps_Female", "MarineCorps_Total", "AirForce_Male", "AirForce_Female", "AirForce_Total", "SpaceForce_Male", "SpaceForce_Female", "SpaceForce_Total", "Total_Male", "Total_Female", "Total_Total") #change the column names so they can actually be used

US_Troops = US_Troops %>%
  filter(Pay_Grade != "Pay Grade") # get rid of the pay_grade row which caused problems when trying to pivot

US_Troops_TidySoldiers = US_Troops %>%
  pivot_longer(cols = c("Army_Male", "Army_Female", "Army_Total", "Navy_Male", "Navy_Female", "Navy_Total", "MarineCorps_Male", "MarineCorps_Female", "MarineCorps_Total", "AirForce_Male", "AirForce_Female", "AirForce_Total", "SpaceForce_Male", "SpaceForce_Female", "SpaceForce_Total", "Total_Male", "Total_Female", "Total_Total"), names_to = c("branch", "gender"), names_sep = "_", values_to = "troops") %>% #the pivot function will help make each branch of the army and the genders their own cases and also make a new column called troops, which will have the number of troops in each case
  filter(gender != "Total") %>% #get rid of the cases that have a gender of Total
  mutate(troops = parse_number(troops)) %>% #this will get rid of the commas that are in the number of troops listed, and then turn the numbers that are currently in character form into actual numbers now
  filter(!is.na(troops)) %>% #this will get rid of the NA values that we do not need in the cases
  filter(branch != "Total") %>% #get rid of the cases where branch was equal to Total
  filter(Pay_Grade != "Total Enlisted") %>% #these next 4 filter functions get rid of parts that were unnecessary and would clean up the dataset if they were gone
  filter(Pay_Grade != "Total Warrant Officers") %>%
  filter(Pay_Grade != "Total Officers") %>%
  filter(Pay_Grade != "Total") %>%
  uncount(troops) #for every number in each row, it will make that many cases with the identical other columns, like if there are 100 people in one group of troops, then it will make 100 cases that are identical to it and will get rid of the troops column

kable(head(US_Troops_TidySoldiers, 25), caption = "Figure 1: Data set where each case is a soldier, listing their pay grade, branch, and gender") # create table for the US_Troops_TidySoldiers data set
```

### Exploring Frequency of Army Troops Gender, That are in the Enlisted Rank

```{r}
frequency_table <- US_Troops_TidySoldiers %>%
  filter(branch == "Army") %>% #only include troops from the army branch
  filter(Pay_Grade == "E1"| Pay_Grade == "E2"| Pay_Grade == "E3"| Pay_Grade == "E4"| Pay_Grade == "E5"| Pay_Grade == "E6"| Pay_Grade == "E7"| Pay_Grade == "E8"| Pay_Grade == "E9") #only include troops that are part of the enlisted rank

frequency_table <- frequency_table %>%
  group_by(Pay_Grade, gender) %>% #organizes the table so that each case is a different combination of the rank of the troops or their gender
  summarize(Frequency = n()) %>% #creates a new column that counts the number of troops that fits each case
  rename("Pay Grade" = Pay_Grade, "Gender" = gender)

kable(head(frequency_table, 25), caption = "Figure 2: Data set of frequencies of a pay grade and gender pair, where each case is unique") # create table for the frequency_table data set
```

### US Armed Soldiers Narrative Text

The table that is produced by the code, shows the number of male and female soldiers that are a part of the army in different Pay Grade ranks. The table shows that there are typically a much larger amount of troops with the male gender in a certain Pay Grade compared to those with a female gender in that Pay Grade. The frequency of troops in the Pay Grade rises as the Pay Grade rank rises, until the Pay Grade rank reaches about E4. Once this happens the frequency of troops also starts to decrease. This means that E4 is the peak rank for the highest frequency of troops. This also suggests that the Pay Grade and Gender of the troops are not independent and affect each other. It also suggests that maybe after a certain rank, the number of troops that get promoted becomes less and less.

## Baby Names Problem

### Baby Names Data Set

```{r}
#Names to be plotted
names <- c("James", "William", "Alexander", "Thomas", "Taylor", "Travis")

#Wrangling Data so that all male and female cases with same name and year have their counts combined, then filter out the names that I don't want
New_Names <- babynames %>%
  
  group_by(name, year) %>%
  
  summarise(
    total_names = sum(n), #adds all of the males and females with the same name and birth year
    .groups = "drop"
      ) %>%
  
  filter(
    name %in% names #removes all names that are not part of our originally selected names 
  )

#Plotting the data onto a line plot
ggplot(New_Names, aes(
  x = year, # x-axis as the year
  y = total_names, # y-axis as the total names for that year
  color = name, # color of line is different for different names
  linetype = name # pattern of line is different for different names
  )
  
  ) + geom_line(
    
  ) + labs( #relabel the x-axis, y-axis, title, and key for the colors 
  x = "Year",
  y = "Total Count of Names",
  title = "Figure 3: Plot 1: Popularity of Selected Names Over Time",
  color = "Selected Names",
  linetype = "Selected Names",
  alt = "Line shows popularity of 6 names, with Alexander, James and Taylor becoming really popular in the 1940s and 1950s, while the names Thomas, Travis, and William became more popular in the 1980s and 1990s"
)
```

### Baby Names Narrative Text

The plot shows the selected names: James, William, Thomas, Alexander, Taylor, and Travis, which were chosen for no specific reason, and the plot shows a lot of common trends between the names. The plot shows that these names did not become popular until around 1910. During that time the names James and William both began to become popular pretty quickly, with the name Thomas growing in popularity but pretty slowly. Meanwhile the other names remained unpopular, and around the 1950s was when James, William and Thomas reached their peak popularity. James being the most popular with around 95,000 being named James at its most popular, then William was the second most popular at that time, and then Thomas. After the 1950s, these 3 names all moderately decreased in popularity. The other names: Taylor, Alexander, and Travis, were all unpopular until the late 1980s,when they began to start gaining popularity, and reaching their peak popularities in the 1990s. After this, all of these names also started to decrease in popularity. Overall, the plot shows the names did not really become popular until the 1910s, when 3 names started to gain popularity and then reach their peaks around 1950. The other names gained popularity around the 1980s and then reach their peak in the 1990s, and after their peaks, all of the names decreased in popularity at around the same rates.

## Box Problem

### Code & Visualization for Box Problem

```{r}
#Code for function
volume.box <- function(x){ #volume function that has length of square as 48 inches & width of square as 36 inches
  nLength <- (48 - 2*x) #length of box where it is the length of the square side, but minus 2x
  nWidth <- (36 - 2*x) #width of box where it is the width of the square side, but minus 2x
  volume <- (nLength * nWidth * x) #volume of box is length of box times width of box times x
  return(volume)
}

#Code to create visualization
ggplot(
  data = data.frame(x = seq(0, 18, 0.1)), #make a plot of function with cuts only going up to 18 because more than that would give negative numbers
  aes(x = x)
  ) +
  stat_function(fun = volume.box) + #use the volume.box function for the plot
  labs( # relabel the x-axis, y-axis, and title
    title = "Figure 4: Volume of Box Function",
    x = "Cut size in inches",
    y = "Volume of Box",
    alt = "As cut size increases, so does the volume of box until around 7 inch cuts, after that the volume of box decreases until around 18 inch cuts, where the box reaches a volume of 0."
  )
```

### Box Problem Narrative Text

The plot shows that as the cut size increases, the volume of the box also increases. This increase of volume size lessens as the cut size approaches the cut size of 6.789 inches, at which point the volume of the box reaches its maximum value of 5239.819 inches cubed. After the plot reaches its peak, the volume of the box begins to decrease at a high rate as the cut size increases until the cut size reaches around 18 inches at which point the volume reaches 0. As the volume of the box value starts to decrease, the rate at which it decreases becomes less and less as the cut size increases, which means that it is decreasing at a high rate at first, but after the cut size increases, the rate at which it is decreasing is a more moderate rate.

## What I have learned so far

This class has taught me a lot of different things that are very useful. The main thing that I learned was how to use R and RStudio, and I learned how to use them to manipulate data or shape it in a way that I want to present it. An example would be like baby names problem, where I took a data set and was able to remove all the cases that I did not want, and then it allowed me to look at trends in the data set. The class has also taught me how to take a data set and create a plot or table from it. This is very useful because it makes it so you can easily see trends in data but you can also present the data to others in a way that is easier for them to understand. An example could also be the baby names problem, where I took the modified data set and then created a plot which made it easy to see trends in how names popularity changed over the years. Another thing that I learned was which types of plots should be used in different situations like whether a histogram, line graph, or a box plot would be more useful. Also, I learned how to find important information about data sets, like the mean, median, standard deviation and other useful statistics. This class really taught me a lot of really useful skills that can help me manipulate, create visualizations, and understand data better.

## Code Appendix

```{r, echo=TRUE, results='hide'}
# All of the code that was used in this qmd file

library(babynames)

library(ggplot2)
library(tidyr)
library(dplyr)
library(readr)

colnames(US_Troops) = c("Pay_Grade", "Army_Male", "Army_Female", "Army_Total", "Navy_Male", "Navy_Female", "Navy_Total", "MarineCorps_Male", "MarineCorps_Female", "MarineCorps_Total", "AirForce_Male", "AirForce_Female", "AirForce_Total", "SpaceForce_Male", "SpaceForce_Female", "SpaceForce_Total", "Total_Male", "Total_Female", "Total_Total") #change the column names so they can actually be used

US_Troops = US_Troops %>%
  filter(Pay_Grade != "Pay Grade") # get rid of the pay_grade row which caused problems when trying to pivot

US_Troops_TidySoldiers = US_Troops %>%
  pivot_longer(cols = c("Army_Male", "Army_Female", "Army_Total", "Navy_Male", "Navy_Female", "Navy_Total", "MarineCorps_Male", "MarineCorps_Female", "MarineCorps_Total", "AirForce_Male", "AirForce_Female", "AirForce_Total", "SpaceForce_Male", "SpaceForce_Female", "SpaceForce_Total", "Total_Male", "Total_Female", "Total_Total"), names_to = c("branch", "gender"), names_sep = "_", values_to = "troops") %>% #the pivot function will help make each branch of the army and the genders their own cases and also make a new column called troops, which will have the number of troops in each case
  filter(gender != "Total") %>% #get rid of the cases that have a gender of Total
  mutate(troops = parse_number(troops)) %>% #this will get rid of the commas that are in the number of troops listed, and then turn the numbers that are currently in character form into actual numbers now
  filter(!is.na(troops)) %>% #this will get rid of the NA values that we do not need in the cases
  filter(branch != "Total") %>% #get rid of the cases where branch was equal to Total
  filter(Pay_Grade != "Total Enlisted") %>% #these next 4 filter functions get rid of parts that were unnecessary and would clean up the dataset if they were gone
  filter(Pay_Grade != "Total Warrant Officers") %>%
  filter(Pay_Grade != "Total Officers") %>%
  filter(Pay_Grade != "Total") %>%
  uncount(troops) #for every number in each row, it will make that many cases with the identical other columns, like if there are 100 people in one group of troops, then it will make 100 cases that are identical to it and will get rid of the troops column
kable(head(US_Troops_TidySoldiers, 25), caption = "Figure 1: Data set where each case is a soldier, listing their pay grade, branch, and gender") # create table for the US_Troops_TidySoldiers data set

frequency_table <- US_Troops_TidySoldiers %>%
  filter(branch == "Army") %>% #only include troops from the army branch
  filter(Pay_Grade == "E1"| Pay_Grade == "E2"| Pay_Grade == "E3"| Pay_Grade == "E4"| Pay_Grade == "E5"| Pay_Grade == "E6"| Pay_Grade == "E7"| Pay_Grade == "E8"| Pay_Grade == "E9") #only include troops that are part of the enlisted rank

frequency_table <- frequency_table %>%
  group_by(Pay_Grade, gender) %>% #organizes the table so that each case is a different combination of the rank of the troops or their gender
  summarize(Frequency = n()) %>% #creates a new column that counts the number of troops that fits each case
  rename("Pay Grade" = Pay_Grade, "Gender" = gender)

kable(head(frequency_table, 25), caption = "Figure 2: Data set of frequencies of a pay grade and gender pair, where each case is unique") # create table for the frequency_table data set

#Names to be plotted
names <- c("James", "William", "Alexander", "Thomas", "Taylor", "Travis")

#Wrangling Data so that all male and female cases with same name and year have their counts combined, then filter out the names that I don't want
New_Names <- babynames %>%
  
  group_by(name, year) %>%
  
  summarise(
    total_names = sum(n), #adds all of the males and females with the same name and birth year
    .groups = "drop"
      ) %>%
  
  filter(
    name %in% names #removes all names that are not part of our originally selected names 
  )

#Plotting the data onto a line plot
ggplot(New_Names, aes(
  x = year, # x-axis as the year
  y = total_names, # y-axis as the total names for that year
  color = name, # color of line is different for different names
  linetype = name # pattern of line is different for different names
  )
  
  ) + geom_line(
    
  ) + labs( #relabel the x-axis, y-axis, title, and key for the colors 
  x = "Year",
  y = "Total Count of Names",
  title = "Figure 3: Popularity of Selected Names Over Time",
  color = "Selected Names",
  linetype = "Selected Names",
  alt = "Line shows popularity of 6 names, with Alexander, James and Taylor becoming really popular in the 1940s and 1950s, while the names Thomas, Travis, and William became more popular in the 1980s and 1990s"
)

#Code for function
volume.box <- function(x){ #volume function that has length of square as 48 inches & width of square as 36 inches
  nLength <- (48 - 2*x) #length of box where it is the length of the square side, but minus 2x
  nWidth <- (36 - 2*x) #width of box where it is the width of the square side, but minus 2x
  volume <- (nLength * nWidth * x) #volume of box is length of box times width of box times x
  return(volume)
}

#Code to create visualization
ggplot(
  data = data.frame(x = seq(0, 18, 0.1)), #make a plot of function with cuts only going up to 18 because more than that would give negative numbers
  aes(x = x)
  ) +
  stat_function(fun = volume.box) + #use the volume.box function for the plot
  labs( # relabel the x-axis, y-axis, and title
    title = "Figure 4: Volume of Box Function",
    x = "Cut size in inches",
    y = "Volume of Box",
    alt = "As cut size increases, so does the volume of box until around 7 inch cuts, after that the volume of box decreases until around 18 inch cuts, where the box reaches a volume of 0."
  )
```
